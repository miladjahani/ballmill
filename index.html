<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>محاسبه‌گر آسیاب گلوله‌ای حرفه‌ای</title>
    <meta name="description" content="ابزار تخصصی طراحی و محاسبه آسیاب گلوله‌ای با قابلیت‌های پیشرفته مهندسی">
    <meta name="keywords" content="آسیاب گلوله‌ای, طراحی مهندسی, محاسبات معدن, Ball Mill Calculator">
    <meta name="author" content="میلاد جهانی - مهندس معدن">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="محاسبه‌گر آسیاب گلوله‌ای حرفه‌ای">
    <meta property="og:description" content="ابزار تخصصی طراحی و محاسبه آسیاب گلوله‌ای">
    <meta property="og:type" content="website">
    <meta property="og:locale" content="fa_IR">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMTYiIGN5PSIxNiIgcj0iMTIiIGZpbGw9IiMzQjgyRjYiLz4KPGNpcmNsZSBjeD0iMTYiIGN5PSIxNiIgcj0iOCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLXdpZHRoPSIyIi8+CjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjIwIiBjeT0iMTIiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjE2IiBjeT0iMjAiIHI9IjIiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPgo=">
    
    <!-- Preload critical resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Persian/Arabic font support -->
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Theme color for mobile browsers -->
    <meta name="theme-color" content="#3B82F6">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="آسیاب‌ کالکولاتور">
    
    <!-- Performance optimizations -->
    <meta name="format-detection" content="telephone=no">
    <meta name="msapplication-tap-highlight" content="no">
    
    <style>
        /* Critical CSS for initial render */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            font-family: 'Vazirmatn', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            direction: rtl;
        }
        
        body {
            background-color: #f8fafc;
            color: #1e293b;
            line-height: 1.6;
            font-size: 16px;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* Loading screen */
        #loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            color: white;
        }
        
        .loading-logo {
            width: 80px;
            height: 80px;
            margin-bottom: 20px;
            animation: spin 2s linear infinite;
        }
        
        .loading-text {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .loading-subtitle {
            font-size: 16px;
            opacity: 0.8;
            margin-bottom: 30px;
        }
        
        .loading-progress {
            width: 200px;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            overflow: hidden;
        }
        
        .loading-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #fbbf24, #f59e0b);
            border-radius: 2px;
            animation: loading 2s ease-in-out infinite;
            transform-origin: left;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @keyframes loading {
            0% { transform: scaleX(0); }
            50% { transform: scaleX(0.7); }
            100% { transform: scaleX(1); }
        }
        
        /* Hide loading screen when app is ready */
        .app-ready #loading-screen {
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease-out;
        }
        
        /* Root container */
        #root {
            min-height: 100vh;
            opacity: 0;
            transition: opacity 0.5s ease-in;
        }
        
        .app-ready #root {
            opacity: 1;
        }
        
        /* Mobile optimizations */
        @media (max-width: 768px) {
            body {
                font-size: 14px;
            }
            
            .loading-text {
                font-size: 20px;
            }
            
            .loading-subtitle {
                font-size: 14px;
            }
        }
        
        /* High DPI screen optimizations */
        @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
            body {
                -webkit-font-smoothing: subpixel-antialiased;
            }
        }
        
        /* Reduced motion for accessibility */
        @media (prefers-reduced-motion: reduce) {
            .loading-logo,
            .loading-progress-bar {
                animation: none;
            }
        }
        
        /* Print styles */
        @media print {
            #loading-screen {
                display: none !important;
            }
            
            body {
                background: white !important;
                color: black !important;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen">
        <svg class="loading-logo" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="16" cy="16" r="12" fill="currentColor" opacity="0.2"/>
            <circle cx="16" cy="16" r="8" fill="none" stroke="currentColor" stroke-width="2"/>
            <circle cx="12" cy="12" r="2" fill="currentColor"/>
            <circle cx="20" cy="12" r="2" fill="currentColor"/>
            <circle cx="16" cy="20" r="2" fill="currentColor"/>
        </svg>
        <div class="loading-text">محاسبه‌گر آسیاب</div>
        <div class="loading-subtitle">ابزار تخصصی مهندسی معدن</div>
        <div class="loading-progress">
            <div class="loading-progress-bar"></div>
        </div>
    </div>

    <!-- Application Root -->
    <div id="root"></div>

    <!-- Error Fallback -->
    <noscript>
        <div style="text-align: center; padding: 50px; font-family: Vazirmatn, Arial, sans-serif;">
            <h1>JavaScript مورد نیاز است</h1>
            <p>برای استفاده از این برنامه، لطفاً JavaScript مرورگر خود را فعال کنید.</p>
            <p style="margin-top: 20px; color: #666;">
                <strong>محاسبه‌گر آسیاب گلوله‌ای حرفه‌ای</strong><br>
                ابزار تخصصی طراحی و محاسبه مهندسی
            </p>
        </div>
    </noscript>

    <!-- Service Worker Registration (for offline capability) -->
    <script>
        // App initialization and loading management
        document.addEventListener('DOMContentLoaded', function() {
            // Simulate loading time for better UX
            setTimeout(function() {
                document.body.classList.add('app-ready');
            }, 2000);
        });

        // Error handling
        window.addEventListener('error', function(e) {
            console.error('Application Error:', e.error);
            // You could implement error reporting here
        });

        // Performance monitoring
        window.addEventListener('load', function() {
            // Log performance metrics
            if ('performance' in window) {
                const loadTime = performance.timing.loadEventEnd - performance.timing.navigationStart;
                console.log('Page load time:', loadTime + 'ms');
            }
        });

        // Theme detection and preference
        function detectTheme() {
            const savedTheme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            
            if (savedTheme) {
                document.documentElement.classList.toggle('dark', savedTheme === 'dark');
            } else {
                document.documentElement.classList.toggle('dark', prefersDark);
            }
        }
        
        // Apply theme immediately to prevent flash
        detectTheme();
        
        // Listen for system theme changes
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', detectTheme);

        // App-like behavior for mobile
        if ('standalone' in window.navigator && window.navigator.standalone) {
            // Running in standalone mode (PWA)
            document.body.classList.add('standalone');
        }

        // Prevent zoom on input focus (iOS)
        if (/iPad|iPhone|iPod/.test(navigator.userAgent)) {
            const viewport = document.querySelector('meta[name=viewport]');
            if (viewport) {
                viewport.content = 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no';
            }
        }

        // Register service worker for offline functionality
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js', { scope: '/' })
                    .then(function(registration) {
                        console.log('SW registered with scope: ', registration.scope);
                    })
                    .catch(function(registrationError) {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>

    <!-- Module loading for modern browsers -->
    <script type="module">
        // Modern browsers will load the application here
        // The actual React application will be loaded by your build system
        import('./src/main.jsx').catch(err => {
            console.error('Failed to load application:', err);
            // Fallback for module loading failures
            document.getElementById('loading-screen').innerHTML = `
                <div style="text-align: center; color: #ef4444;">
                    <h2>خطا در بارگذاری برنامه</h2>
                    <p>لطفاً صفحه را تازه‌سازی کنید</p>
                    <button onclick="location.reload()" style="margin-top: 20px; padding: 10px 20px; background: #3b82f6; color: white; border: none; border-radius: 5px; cursor: pointer;">
                        تازه‌سازی
                    </button>
                </div>
            `;
        });
    </script>

    <!-- Fallback for older browsers -->
    <script nomodule>
        // Older browsers will show a compatibility message
        document.getElementById('loading-screen').innerHTML = `
            <div style="text-align: center; color: #fbbf24;">
                <h2>مرورگر شما نیاز به به‌روزرسانی دارد</h2>
                <p>برای استفاده بهینه از این برنامه، لطفاً مرورگر خود را به‌روزرسانی کنید.</p>
                <div style="margin-top: 20px;">
                    <a href="https://www.google.com/chrome/" target="_blank" style="color: white; text-decoration: underline;">Chrome</a> | 
                    <a href="https://www.mozilla.org/firefox/" target="_blank" style="color: white; text-decoration: underline;">Firefox</a> | 
                    <a href="https://www.microsoft.com/edge" target="_blank" style="color: white; text-decoration: underline;">Edge</a>
                </div>
            </div>
        `;
    </script>

    <!-- Analytics (replace with your analytics code) -->
    <script>
        // Basic analytics for usage tracking
        function trackEvent(eventName, eventData = {}) {
            if (typeof gtag !== 'undefined') {
                gtag('event', eventName, eventData);
            }
            console.log('Event tracked:', eventName, eventData);
        }

        // Track app initialization
        trackEvent('app_initialized', {
            user_agent: navigator.userAgent,
            screen_resolution: `${screen.width}x${screen.height}`,
            language: navigator.language || 'fa'
        });
    </script>
</body>
</html>